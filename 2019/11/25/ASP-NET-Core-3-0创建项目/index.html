<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="zhendong在github上的个人博客">
    <meta name="keyword" content="">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Zhendong" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        ASP.NET Core 3.0创建项目｜Zhendong&#39;s blog
        
    </title>

    <link rel="canonical" href="https://zhdaa.github.io/2019/11/25/ASP-NET-Core-3-0创建项目/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
</head>

<style>

    header.intro-header {
        background-image: url('/images/zhdaa-headimg.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Zhendong
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
                        
							
                        <li>
                            <a href="/Tags/">Tags</a>
                        </li>
							
						
                    
					
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="/images/post-ocean.jpg">


<style>
    
    header.intro-header {
        background-image: url('/images/post-ocean.jpg')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>ASP.NET Core 3.0创建项目</h1>
                    
                    <span class="meta">
                         作者 Zhendong Ho
                        <span>
                          日期 2019-11-25
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                        <a class="tag" href="/tags/#ASP.NET Core"
                           title="ASP.NET Core">ASP.NET Core</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            ASP.NET Core 3.0创建项目
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <h2 id="创建ASP-NET-Core项目"><a href="#创建ASP-NET-Core项目" class="headerlink" title="创建ASP.NET Core项目"></a>创建ASP.NET Core项目</h2><p>打开Visual Studio 2019，点击创建项目，选择ASP.NET Core Web 应用程序。</p>
<p><img src="1574346123789.png" alt="1574346123789"></p>
<p>点击<strong>编辑项目文件</strong>，可以看到项目的框架是.NET Core 3.0。</p>
<p><img src="1574347099007.png" alt="1574347099007"></p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>ASP.NET Core项目的本质是一个<strong>.NET Core控制台项目</strong>，项目结构如下。</p>
<p><img src="1574347143374.png" alt="1574347143374"></p>
<h3 id="Program类"><a href="#Program类" class="headerlink" title="Program类"></a>Program类</h3><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        CreateHostBuilder(args).Build().Run();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IHostBuilder <span class="title">CreateHostBuilder</span>(<span class="params"><span class="keyword">string</span>[] args</span>) </span>=&gt;</span><br><span class="line">        Host.CreateDefaultBuilder(args)</span><br><span class="line">            .ConfigureWebHostDefaults(webBuilder =&gt; </span><br><span class="line">            &#123;</span><br><span class="line">                webBuilder.UseStartup&lt;Startup&gt;();</span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Main方法</strong>：程序执行的入口，<strong>配置整个应用并运行</strong>。</p>
<p><strong>CreateHostBuilder方法</strong>：调用CreateDefaultBuilder方法，<strong>对WebHost进行配置</strong>，如处理配置文件、路由等。</p>
<h3 id="Startup类"><a href="#Startup类" class="headerlink" title="Startup类"></a>Startup类</h3><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Startup</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 用于配置依赖注入</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 判断是否开发模式</span></span><br><span class="line">        <span class="keyword">if</span> (env.IsDevelopment())</span><br><span class="line">        &#123;</span><br><span class="line">            app.UseDeveloperExceptionPage();	<span class="comment">// 发生错误时把信息展示到页面的中间件</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        app.UseRouting();	<span class="comment">// 路由中间件</span></span><br><span class="line">        </span><br><span class="line">        app.UseEndpoints(endpoints =&gt;	<span class="comment">// 端点中间件，使用Lambda表达式</span></span><br><span class="line">        &#123;</span><br><span class="line">            endpoints.MapGet(<span class="string">"/"</span>, <span class="keyword">async</span> context =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">"Hello World!"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Startup类用于<strong>相对动态</strong>的配置（相对CreateHostBuilder）。</p>
<p><strong>调用顺序</strong>：先调用<strong>ConfigureServices</strong>，再调用<strong>Configure</strong>。</p>
<p><strong>ConfigureServices</strong>：负责<strong>配置依赖注入</strong>相关内容。</p>
<p><strong>Configure</strong>：配置了ASP.NET Core处理<strong>HTTP请求的管道（注册中间件）</strong>。</p>
<h2 id="DI依赖注入"><a href="#DI依赖注入" class="headerlink" title="DI依赖注入"></a>DI依赖注入</h2><h3 id="IOC容器"><a href="#IOC容器" class="headerlink" title="IOC容器"></a>IOC容器</h3><p>当应用程序启动时，一些类型会在容器中进行<strong>注册</strong>。这些类型称为<strong>服务（services）</strong>。注册之后，<strong>其他的类型或它本身</strong>，都可以向IOC容器<strong>请求这些注册的实例</strong>。另外，注册的时候可以<strong>设定这些实例的生命周期</strong>。</p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p><strong>Transient</strong>：services每次被请求时生成新的实例。</p>
<p><strong>Scoped</strong>：一次web请求产生一个实例，web请求处理完生命周期结束。</p>
<p><strong>Singleton</strong>：实例一旦被创建，所有请求使用同一个实例，直到应用程序停止。</p>
<h3 id="注册MVC服务"><a href="#注册MVC服务" class="headerlink" title="注册MVC服务"></a>注册MVC服务</h3><p>例：通过依赖注入注册一个MVC服务。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    services.AddControllersWithViews();	<span class="comment">// 注册MVC</span></span><br><span class="line">    <span class="comment">// services.AddRazorPages();        // 支持RazorPgae</span></span><br><span class="line">    <span class="comment">// services.AddController();        // 用于WebAPI</span></span><br><span class="line">    <span class="comment">// services.AddMvc();               // 功能最多</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="注册自定义服务"><a href="#注册自定义服务" class="headerlink" title="注册自定义服务"></a>注册自定义服务</h3><p>项目右键，新建文件夹Services，在Services下新建接口IClock。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IClock</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新建ChinaClock实现IClock接口。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChinaClock</span> : <span class="title">IClock</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新建UtcClock实现IClock接口。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UtcClock</span> : <span class="title">IClock</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Startup类中注册ChinaClock服务。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    services.AddControllersWithViews();</span><br><span class="line">    services.AddSingleton&lt;IClock, ChinaClock&gt;(); <span class="comment">// 每当有其他类型实现IClock时，返回ChinaClock实例</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用服务"><a href="#使用服务" class="headerlink" title="使用服务"></a>使用服务</h3><p>项目右键，添加文件夹Controllers，在Controllers下新建类HomeController。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HomeController</span> : <span class="title">Controller</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeController</span>(<span class="params">IClock clock</span>)	<span class="comment">// 通过构造函数注入</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DI的优点"><a href="#DI的优点" class="headerlink" title="DI的优点"></a>DI的优点</h3><ol>
<li>解耦，没有强依赖，利于单元测试。</li>
<li>不需要了解具体的服务类。</li>
<li>也不需要管理服务类的生命周期。</li>
</ol>
<h2 id="ASP-NET-Core管道"><a href="#ASP-NET-Core管道" class="headerlink" title="ASP.NET Core管道"></a>ASP.NET Core管道</h2><p><strong>ASP.NET Core管道（pipeline）</strong>可以指定应用程序<strong>如何响应HTTP请求</strong>。</p>
<p><strong>原理</strong>：ASP.NET Core从浏览器接收到HTTP请求，<strong>请求从浏览器进入管道，处理完后从管道回去</strong>。我们把管道中间的，可以处理请求的内容称为<strong>中间件</strong>，如MVC、Auth等。</p>
<p><img src="1574692790466.png" alt="1574692790466"></p>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><h3 id="端点endpoint"><a href="#端点endpoint" class="headerlink" title="端点endpoint"></a>端点endpoint</h3><p>端点就是进来的HTTP请求的<strong>url结尾的那部分</strong>，这部分会被中间件进行处理。如：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// /&#123;controller&#125;/&#123;action&#125;</span></span><br><span class="line"><span class="comment">// /home/index</span></span><br></pre></td></tr></table></figure>
<h3 id="路由中间件"><a href="#路由中间件" class="headerlink" title="路由中间件"></a>路由中间件</h3><p>在ASP.NET Core 3.0， 路由中间件<strong>从MVC中</strong>被分离出来，单独作为一个中间件使用。</p>
<p>多种ASP.NET Core应用都需要使用<strong>路由中间件</strong>。</p>
<ul>
<li>MVC：/Home/Index</li>
<li>Razor Pages：/SomePage</li>
<li>SignalR：/Hub/Chat</li>
</ul>
<p><strong>配置路由的方式</strong>：有两种方法。<strong>一种是在Controller前加上Attribure，另一种是配置路由模板</strong>。</p>
<p>例：在Configure类中注册路由中间件以及配置路由模板。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    app.UseRouting();	<span class="comment">// 注册路由中间件</span></span><br><span class="line">    </span><br><span class="line">    app.UseEnpoints(endpoints =&gt;	<span class="comment">// 注册端点中间件，这里配置路由模板</span></span><br><span class="line">    &#123;</span><br><span class="line">        endpoints.MapControllerRoute(</span><br><span class="line">            name: <span class="string">"default"</span>,</span><br><span class="line">            pattern: <span class="string">"&#123;controller=Home&#125;/&#123;action=Index&#125;/&#123;id?&#125;"</span>);</span><br><span class="line">        <span class="comment">// 如果使用Attribute配置路由，则使用以下方法</span></span><br><span class="line">        <span class="comment">// endpoints.MapControllers();</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="其他中间件"><a href="#其他中间件" class="headerlink" title="其他中间件"></a>其他中间件</h3><p>其他web应用需要使用的中间件，如静态文件和身份认证中间件。<strong>注意中间件的注册顺序很重要，中间件注册的顺序就是HTTP请求在管道中处理的顺序</strong>。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    app.UseStaticFiles();	<span class="comment">// 静态文件中间件，可写在路由中间件前，不需要知道路由信息</span></span><br><span class="line">    </span><br><span class="line">    app.UseHttpRedirection();	<span class="comment">// 把HTTP请求转换成HTTPS请求</span></span><br><span class="line">    </span><br><span class="line">    app.UseRouting();	<span class="comment">// 路由中间件</span></span><br><span class="line">    </span><br><span class="line">    app.UseAuthentication();	<span class="comment">// 身份认证中间件，必须写在UseEndpoints前，使用框架前必须要身份认证</span></span><br><span class="line">    </span><br><span class="line">    endpoints.MapControllerRoute(</span><br><span class="line">            name: <span class="string">"default"</span>,</span><br><span class="line">            pattern: <span class="string">"&#123;controller=Home&#125;/&#123;action=Index&#125;/&#123;id?&#125;"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="运行ASP-NET-Core应用"><a href="#运行ASP-NET-Core应用" class="headerlink" title="运行ASP.NET Core应用"></a>运行ASP.NET Core应用</h2><p>有两种方式运行。第一种是通过<strong>IIS Express（不推荐）</strong>，第二种是运行<strong>ASP.NET Core应用（控制台）</strong>。推荐使用第二种。</p>
<p><img src="1574774746653.png" alt="1574774746653"></p>
<h3 id="配置运行的方式"><a href="#配置运行的方式" class="headerlink" title="配置运行的方式"></a>配置运行的方式</h3><p>有两种方式可以<strong>修改项目相关配置</strong>。</p>
<ul>
<li>项目右键，点击属性，选择调试。</li>
</ul>
<p><img src="1574774916243.png" alt="1574774916243"></p>
<ul>
<li><p>打开项目文件夹，Properties目录下的<strong>launchSettings.json文件（项目中不可见）</strong>，该文件对应上面的配置内容。</p>
<p><img src="1574775328865.png" alt="1574775328865"></p>
<p>如果不需要使用IIS Express，可以删除IIS的相关配置。</p>
</li>
</ul>
<h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><p>通过修改环境变量<strong>ASPNETCORE_ENVIRONMENT</strong>，可以在Startup类的<strong>Configure方法</strong>中<strong>判断不同的环境</strong>。</p>
<p>例：自定义环境变量。</p>
<p><img src="1574776092042.png" alt="1574776092042"></p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (env.IsEnvironment(<span class="string">"Ok"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        app.UseDeveloperExceptionPage();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="环境配置方法"><a href="#环境配置方法" class="headerlink" title="环境配置方法"></a>环境配置方法</h3><p>ASP.NET Core可以根据不同的配置环境，写不同的配置方法。</p>
<p>例：使用ConfigureDevelopment配置开发环境。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureDevelopment</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 开发环境的配置</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：<strong>ConfigureServices方法</strong>和<strong>Startup类</strong>，也可以使用这种<strong>约定名称</strong>来配置<strong>环境方法</strong>或<strong>环境类</strong>。</p>
<h2 id="静态文件"><a href="#静态文件" class="headerlink" title="静态文件"></a>静态文件</h2><h3 id="wwwroot文件夹"><a href="#wwwroot文件夹" class="headerlink" title="wwwroot文件夹"></a>wwwroot文件夹</h3><p><strong>wwwroot文件夹</strong>是一个特殊的文件夹，用于存放<strong>静态文件</strong>，如javascript、css、图片、字体等。</p>
<p>项目右键，添加wwwroot文件夹，在wwwroot下添加images文件夹，在images下添加图片。</p>
<p><img src="1574777386631.png" alt="1574777386631"></p>
<p>运行项目，在地址栏输入localhost:5001/images/ae86.jpg，即可看到图片。</p>
<p><img src="1574777483224.png" alt="1574777483224"></p>
<p><strong>注意</strong>：由于配置中使用<strong>UseStaticFiles方法</strong>注册了<strong>静态文件中间件</strong>，否则无法获取静态资源。</p>
<h2 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h2><ul>
<li>服务器端（后端）：Nuget</li>
<li>前端：Npm</li>
</ul>
<h3 id="通过Npm安装Bootstrap"><a href="#通过Npm安装Bootstrap" class="headerlink" title="通过Npm安装Bootstrap"></a>通过Npm安装Bootstrap</h3><p>项目右键，添加npm配置文件。</p>
<p><img src="1574780530920.png" alt="1574780530920"></p>
<p>在配置文件中，添加bootstrap，选择最新版本，保存的时候自动安装。</p>
<p><img src="1574780711546.png" alt="1574780711546"></p>
<p>安装完成后，可以在项目路径的node_modules目录下，看到安装好的Bootstrap（项目中不可见）。</p>
<p><strong>注意</strong>：如果删除bootstrap，只需要在json文件中删除，保存后会<strong>自动删除对应的包和目录</strong>。</p>
<h3 id="通过libman安装Bootstrap"><a href="#通过libman安装Bootstrap" class="headerlink" title="通过libman安装Bootstrap"></a>通过libman安装Bootstrap</h3><p>libman是Visual Studio自带的工具。</p>
<p>项目右键，添加<strong>客户端库</strong>，提供程序选择<strong>unpkg</strong>，库输入<strong><code>bootstrap@4.3.1</code></strong>，确认目标位置，安装。</p>
<p><img src="1574781587927.png" alt="1574781587927"></p>
<p>安装完成后，有如下改变：</p>
<ol>
<li>把文件添加到指定的目录中。</li>
<li>项目中增加了一个libman.json文件。</li>
</ol>
<p><img src="1574781747921.png" alt="1574781747921"></p>
<h2 id="合并和压缩css"><a href="#合并和压缩css" class="headerlink" title="合并和压缩css"></a>合并和压缩css</h2><p>在wwwroot下创建css文件夹，在css下添加site.css。</p>
<h3 id="使用bundle合并"><a href="#使用bundle合并" class="headerlink" title="使用bundle合并"></a>使用bundle合并</h3><p>项目右键，新建bundleconfig.json文件，配置以下内容。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"outputFileName"</span>: <span class="string">"wwwroot/css/all.min.css"</span>,</span><br><span class="line">    <span class="attr">"inputFiles"</span>: [</span><br><span class="line">      <span class="string">"wwwroot/lib/bootstrap/dist/css/bootstrap.css"</span>,</span><br><span class="line">      <span class="string">"wwwroot/css/site.css"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"outputFileName"</span>: <span class="string">"wwwroot/css/bootstrap.css"</span>,</span><br><span class="line">    <span class="attr">"inputFiles"</span>: [</span><br><span class="line">      <span class="string">"wwwroot/lib/bootstrap/dist/css/bootstrap.css"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"minify"</span>: &#123;</span><br><span class="line">      <span class="attr">"enabled"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><strong>第一项</strong>：把site.css和bootstrap.css<strong>合并</strong>为all.min.css。</p>
<p><strong>第二项</strong>：把bootstrap.css移动到wwwroot/css/bootstrap.css，并<strong>使用minify工具压缩</strong>。</p>
<h3 id="通过Nuget安装BuildBundlerMinifier包"><a href="#通过Nuget安装BuildBundlerMinifier包" class="headerlink" title="通过Nuget安装BuildBundlerMinifier包"></a>通过Nuget安装BuildBundlerMinifier包</h3><p>项目右键，点击管理Nuget程序包，把BuildBundlerMinifier安装到项目中。点击rebuild项目。</p>
<p>看到目录下有对应的文件了。</p>
<p><img src="1574783687508.png" alt="1574783687508"></p>

                <hr>
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/11/29/ASP-NET-Core-MVC相关技术/" data-toggle="tooltip" data-placement="top"
                           title="ASP.NET Core MVC相关技术">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2019/09/09/C-各个版本的新特性/" data-toggle="tooltip" data-placement="top"
                           title="C#各个版本的新特性">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                


                <!--加入新的评论系统-->
                

                

            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建ASP-NET-Core项目"><span class="toc-text">创建ASP.NET Core项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#项目结构"><span class="toc-text">项目结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Program类"><span class="toc-text">Program类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Startup类"><span class="toc-text">Startup类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DI依赖注入"><span class="toc-text">DI依赖注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IOC容器"><span class="toc-text">IOC容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生命周期"><span class="toc-text">生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册MVC服务"><span class="toc-text">注册MVC服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册自定义服务"><span class="toc-text">注册自定义服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用服务"><span class="toc-text">使用服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DI的优点"><span class="toc-text">DI的优点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ASP-NET-Core管道"><span class="toc-text">ASP.NET Core管道</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由"><span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#端点endpoint"><span class="toc-text">端点endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#路由中间件"><span class="toc-text">路由中间件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他中间件"><span class="toc-text">其他中间件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行ASP-NET-Core应用"><span class="toc-text">运行ASP.NET Core应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置运行的方式"><span class="toc-text">配置运行的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置环境变量"><span class="toc-text">设置环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置方法"><span class="toc-text">环境配置方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#静态文件"><span class="toc-text">静态文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#wwwroot文件夹"><span class="toc-text">wwwroot文件夹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#包管理"><span class="toc-text">包管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通过Npm安装Bootstrap"><span class="toc-text">通过Npm安装Bootstrap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过libman安装Bootstrap"><span class="toc-text">通过libman安装Bootstrap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#合并和压缩css"><span class="toc-text">合并和压缩css</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用bundle合并"><span class="toc-text">使用bundle合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过Nuget安装BuildBundlerMinifier包"><span class="toc-text">通过Nuget安装BuildBundlerMinifier包</span></a></li></ol></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#ASP.NET Core"
                           title="ASP.NET Core">ASP.NET Core</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <div style="margin-top: 20px;">
                    <h5 class="text-center">FRIENDS</h5>
                    <ul class="list-inline text-center">
                        
                        <li><a href="http://laibh.top">赖同学</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>

    </div>
</article>







<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Zhendong 2021
                    <br>
                    <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span>
                    <br>
                    Theme by <a href="https://haojen.github.io/">Haojen Ma</a>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://zhdaa.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    var _baId = '4cc1f2d8f3067386cc5cdb626a202900';
    // Originial
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','','2.0.0');
</script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!--wechat title img-->
<img class="wechat-title-img" src="/images/zhdaa-headimg.jpg">
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
